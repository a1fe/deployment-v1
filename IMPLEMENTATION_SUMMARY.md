# üèÅ –ó–ê–í–ï–†–®–ï–ù–ò–ï: CPU/GPU –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ
- **CPU-—Å–µ—Ä–≤–µ—Ä (e2-standard-2)**: –ü–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–∏–π –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä
- **GPU-—Å–µ—Ä–≤–µ—Ä (n1-standard-4 + T4)**: –í–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é –¥–ª—è GPU –∑–∞–¥–∞—á
- **Redis**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ CPU-—Å–µ—Ä–≤–µ—Ä–µ

### 2. üîÑ –£—Å–ª–æ–≤–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á
- **–ë–µ–∑ GPU_INSTANCE_NAME**: –í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ CPU
- **–° GPU_INSTANCE_NAME**: GPU –∑–∞–¥–∞—á–∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è –Ω–∞ GPU-–æ—á–µ—Ä–µ–¥–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ**: –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞

### 3. üìÇ –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
```
deployment/
‚îú‚îÄ‚îÄ celery_app/
‚îÇ   ‚îî‚îÄ‚îÄ celery_env_config.py           # ‚úÖ –£—Å–ª–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ cpu-server/
‚îÇ   ‚îî‚îÄ‚îÄ start_cpu_celery.sh            # ‚úÖ –°–∫—Ä–∏–ø—Ç CPU –≤–æ—Ä–∫–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ gpu-server/
‚îÇ   ‚îî‚îÄ‚îÄ start_gpu_celery.sh            # ‚úÖ –°–∫—Ä–∏–ø—Ç GPU –≤–æ—Ä–∫–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ gcloud_manager.py              # ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ GPU –∏–Ω—Å—Ç–∞–Ω—Å–æ–º
‚îÇ   ‚îî‚îÄ‚îÄ gpu_monitor.py                 # ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
‚îú‚îÄ‚îÄ architecture_config.py             # ‚úÖ –ú–µ–Ω–µ–¥–∂–µ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ DEPLOYMENT_GUIDE.md               # ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
‚îî‚îÄ‚îÄ README.md                         # ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –æ–±–∑–æ—Ä
```

## üîß –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### celery_env_config.py
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `get_task_routes()` —Å —É—Å–ª–æ–≤–Ω–æ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–µ–π
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `get_worker_configs()` —Å —É—Å–ª–æ–≤–Ω—ã–º–∏ GPU –≤–æ—Ä–∫–µ—Ä–∞–º–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ `GPU_INSTANCE_NAME` –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –°–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞
- ‚úÖ `start_cpu_celery.sh`: –í–æ—Ä–∫–µ—Ä—ã –¥–ª—è CPU –∑–∞–¥–∞—á
- ‚úÖ `start_gpu_celery.sh`: –í–æ—Ä–∫–µ—Ä—ã –¥–ª—è GPU –∑–∞–¥–∞—á
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

### –£—Ç–∏–ª–∏—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ `gcloud_manager.py`: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ GPU –∏–Ω—Å—Ç–∞–Ω—Å–æ–º –≤ GCloud
- ‚úÖ `gpu_monitor.py`: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GPU –∑–∞–¥–∞—á
- ‚úÖ CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üéØ –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã

### 1. –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á
```python
# –ë–µ–∑ GPU_INSTANCE_NAME
'tasks.embedding_tasks.generate_resume_embeddings': {'queue': 'default'}

# –° GPU_INSTANCE_NAME
'tasks.embedding_tasks.generate_resume_embeddings': {'queue': 'embeddings_gpu'}
```

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–æ—Ä–∫–µ—Ä–æ–≤
```python
# –ë–∞–∑–æ–≤—ã–µ –≤–æ—Ä–∫–µ—Ä—ã (–≤—Å–µ–≥–¥–∞)
configs = {'default': {...}, 'fillout': {...}, 'search_basic': {...}}

# + GPU –≤–æ—Ä–∫–µ—Ä—ã (–µ—Å–ª–∏ GPU_INSTANCE_NAME)
if gpu_enabled:
    configs.update({'embeddings_gpu': {...}, 'scoring_tasks': {...}})
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—á–µ—Ä–µ–¥–µ–π GPU –∑–∞–¥–∞—á
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ GPU —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∑–∞–¥–∞—á
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–æ—Å—Ç–æ–µ

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### CPU-—Å–µ—Ä–≤–µ—Ä (–æ—Å–Ω–æ–≤–Ω–æ–π)
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
python deployment/architecture_config.py config

# –ó–∞–ø—É—Å–∫ –≤–æ—Ä–∫–µ—Ä–æ–≤
./deployment/cpu-server/start_cpu_celery.sh

# –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ GPU (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
python deployment/utils/gpu_monitor.py
```

### GPU-—Å–µ—Ä–≤–µ—Ä
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ GPU_INSTANCE_NAME –≤ .env
echo "GPU_INSTANCE_NAME=gpu-server-instance" >> .env

# –ó–∞–ø—É—Å–∫ GPU –≤–æ—Ä–∫–µ—Ä–æ–≤
./deployment/gpu-server/start_gpu_celery.sh
```

### –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ GPU
```bash
# –í–∫–ª—é—á–∏—Ç—å GPU —Å–µ—Ä–≤–µ—Ä
python deployment/utils/gcloud_manager.py start

# –í—ã–∫–ª—é—á–∏—Ç—å GPU —Å–µ—Ä–≤–µ—Ä
python deployment/utils/gcloud_manager.py stop

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
python deployment/utils/gcloud_manager.py status
```

## üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
```bash
# –ë–µ–∑ GPU
python -c "from deployment.celery_app.celery_env_config import get_task_routes; print(get_task_routes())"

# –° GPU
GPU_INSTANCE_NAME=test python -c "from deployment.celery_app.celery_env_config import get_task_routes; print(get_task_routes())"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```bash
python deployment/architecture_config.py validate
```

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ CPU/GPU —Å:

1. **–£—Å–ª–æ–≤–Ω–æ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–µ–π**: –ó–∞–¥–∞—á–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ CPU –∏–ª–∏ GPU
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º**: GPU —Å–µ—Ä–≤–µ—Ä –≤–∫–ª—é—á–∞–µ—Ç—Å—è/–≤—ã–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é
3. **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å—é**: –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ GPU –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ CPU
4. **–≠–∫–æ–Ω–æ–º–∏–µ–π –∑–∞—Ç—Ä–∞—Ç**: GPU —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
5. **–ü—Ä–æ—Å—Ç–æ—Ç–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: –ï–¥–∏–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- `GPU_INSTANCE_NAME` - –≤–∫–ª—é—á–∞–µ—Ç GPU —Ä–µ–∂–∏–º
- `GOOGLE_CLOUD_PROJECT` - –ø—Ä–æ–µ–∫—Ç –≤ GCloud
- `GOOGLE_CLOUD_ZONE` - –∑–æ–Ω–∞ GPU —Å–µ—Ä–≤–µ—Ä–∞

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ
